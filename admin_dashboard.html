{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Admin Dashboard</h3>
  <div>
    <a class="btn btn-primary" href="{{ url_for('add') }}">Add Student</a>
    <a class="btn btn-outline-secondary" href="{{ url_for('export_csv') }}">Export CSV</a>
  </div>
</div>

<form class="mb-3" method="get" action="{{ url_for('admin_dashboard') }}" enctype="multipart/form-data">
  <div class="input-group mb-2">
    <input type="text" name="q" class="form-control" placeholder="Search by name or ID..." value="{{ q }}">
    <button class="btn btn-outline-secondary" type="submit">Search</button>
  </div>
  <div class="mb-2">
    <form action="{{ url_for('import_csv') }}" method="post" enctype="multipart/form-data">
      <input type="file" name="file" accept=".csv" class="form-control-file mb-2">
      <button class="btn btn-success btn-sm" type="submit">Import CSV</button>
    </form>
  </div>
</form>

{% if students|length == 0 %}
  <div class="alert alert-secondary">No students yet.</div>
{% else %}
  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>#</th>
          <th>Student ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Course</th>
          <th>Marks</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for s in students %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ s['student_id'] }}</td>
          <td>{{ s['name'] }}</td>
          <td>{{ s['email'] or '-' }}</td>
          <td>{{ s['course'] or '-' }}</td>
          <td>{{ s['marks'] or '-' }}</td>
          <td>
            <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('edit', stu_id=s['id']) }}">Edit</a>
            <a class="btn btn-sm btn-outline-danger" href="{{ url_for('delete', stu_id=s['id']) }}">Delete</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endif %}
{% endblock %}
